---
description: Run all FVH infrastructure standards checks and configure compliance
allowed-tools: Glob, Grep, Read, Write, Edit, Bash, AskUserQuestion, TodoWrite, SlashCommand
argument-hint: "[--check-only] [--fix] [--type <frontend|infrastructure|python>]"
---

# /configure:all

Run all FVH (Forum Virium Helsinki) infrastructure standards compliance checks.

## Context

Orchestrator command that runs all `/configure:*` subcommands and provides a comprehensive compliance report.

## Workflow

### Phase 1: Project Detection

1. Read `.fvh-standards.yaml` if exists
2. Auto-detect project type:
   - **infrastructure**: Has `terraform/`, `helm/`, `argocd/`, or `*.tf` files
   - **frontend**: Has `package.json` with vue/react dependencies
   - **python**: Has `pyproject.toml` or `requirements.txt`
3. Allow override via `--type` flag
4. Report detected vs tracked type if different

### Phase 2: Run All Checks

Execute each configure command in check-only mode:

```
/configure:makefile --check-only
/configure:pre-commit --check-only
/configure:release-please --check-only
/configure:dockerfile --check-only
/configure:skaffold --check-only
/configure:workflows --check-only
/configure:sentry --check-only
/configure:docs --check-only
/configure:github-pages --check-only
/configure:cache-busting --check-only
/configure:tests --check-only
/configure:coverage --check-only
/configure:linting --check-only
/configure:formatting --check-only
/configure:dead-code --check-only
/configure:editor --check-only
/configure:security --check-only
```

Collect results from each check.

### Phase 3: Generate Comprehensive Report

```
╔══════════════════════════════════════════════════════════════╗
║           FVH Infrastructure Standards Compliance            ║
╠══════════════════════════════════════════════════════════════╣
║  Repository:    R4C-Cesium-Viewer                            ║
║  Project Type:  frontend (detected)                          ║
║  Standards:     2025.1                                       ║
║  Last Check:    2025-11-28 10:30:00                          ║
╚══════════════════════════════════════════════════════════════╝

Component Summary:
┌─────────────────┬──────────┬─────────────────────────────────┐
│ Component       │ Status   │ Notes                           │
├─────────────────┼──────────┼─────────────────────────────────┤
│ Makefile        │ ✅ PASS  │ All targets present             │
│ Pre-commit      │ ⚠️ WARN  │ 2 outdated hooks                │
│ Release-please  │ ✅ PASS  │ Fully compliant                 │
│ Dockerfile      │ ❌ FAIL  │ Missing healthcheck             │
│ Skaffold        │ ✅ PASS  │ 3 profiles configured           │
│ CI Workflows    │ ⚠️ WARN  │ Missing test workflow           │
│ Sentry          │ ✅ PASS  │ SDK configured                  │
│ Documentation   │ ⚠️ WARN  │ Generator configured, no deploy │
│ GitHub Pages    │ ❌ FAIL  │ No workflow configured          │
│ Cache Busting   │ ✅ PASS  │ Content hashing enabled         │
│ Tests           │ ✅ PASS  │ Vitest configured               │
│ Coverage        │ ⚠️ WARN  │ Below 80% threshold             │
│ Linting         │ ✅ PASS  │ Biome configured                │
│ Formatting      │ ✅ PASS  │ Biome configured                │
│ Dead Code       │ ⚠️ WARN  │ 3 unused exports                │
│ Editor          │ ✅ PASS  │ .editorconfig present           │
│ Security        │ ✅ PASS  │ Dependency audit enabled        │
└─────────────────┴──────────┴─────────────────────────────────┘

Overall Status: 1 FAIL, 2 WARN, 3 PASS

Issues to Fix:
  1. [FAIL] Dockerfile: Add HEALTHCHECK instruction
  2. [WARN] Pre-commit: Update conventional-pre-commit v3.6.0 → v4.3.0
  3. [WARN] Pre-commit: Update gruntwork/helmlint v0.1.23 → v0.1.29
  4. [WARN] Workflows: Add test.yml workflow

Run with --fix to apply automatic fixes.
```

### Phase 4: Apply Fixes (If Requested)

If `--fix` flag or user confirms:

1. Run each configure command with `--fix`:
   ```
   /configure:pre-commit --fix
   /configure:release-please --fix
   /configure:dockerfile --fix
   /configure:skaffold --fix
   /configure:workflows --fix
   /configure:sentry --fix
   /configure:docs --fix
   /configure:github-pages --fix
   /configure:cache-busting --fix
   /configure:tests --fix
   /configure:coverage --fix
   /configure:linting --fix
   /configure:formatting --fix
   /configure:dead-code --fix
   /configure:editor --fix
   /configure:security --fix
   ```

2. Report what was fixed and what requires manual intervention

### Phase 5: Update Standards Tracking

Create or update `.fvh-standards.yaml`:

```yaml
# FVH Standards Tracking
# Generated by /configure:all
standards_version: "2025.1"
project_type: "frontend"
last_configured: "2025-11-28T10:30:00Z"

components:
  pre-commit: "2025.1"
  release-please: "2025.1"
  dockerfile: "2025.1"
  skaffold: "2025.1"
  workflows: "2025.1"
  sentry: "2025.1"
  docs: "2025.1"
  github-pages: "2025.1"
  cache-busting: "2025.1"
  tests: "2025.1"
  coverage: "2025.1"
  linting: "2025.1"
  formatting: "2025.1"
  dead-code: "2025.1"
  editor: "2025.1"
  security: "2025.1"

# Documented deviations from standard
deviations: []
```

## Flags

| Flag | Description |
|------|-------------|
| `--check-only` | Report status without offering fixes |
| `--fix` | Apply all fixes automatically |
| `--type <type>` | Override project type (frontend, infrastructure, python) |

## Exit Codes (for CI)

| Code | Meaning |
|------|---------|
| 0 | All checks passed |
| 1 | Warnings found (non-blocking) |
| 2 | Failures found (blocking) |

## Examples

```bash
# Full compliance check with interactive fixes
/configure:all

# CI mode - check only, no fixes
/configure:all --check-only

# Auto-fix all issues
/configure:all --fix

# Force infrastructure type
/configure:all --type infrastructure
```

## Component Applicability

Not all components apply to all project types:

| Component | Frontend | Infrastructure | Python | Rust |
|-----------|----------|----------------|--------|------|
| Pre-commit | ✅ | ✅ | ✅ | ✅ |
| Release-please | ✅ | Optional | ✅ | ✅ |
| Dockerfile | ✅ | ⏭️ SKIP | ✅ | ✅ |
| Skaffold | If k8s/ | ⏭️ SKIP | If k8s/ | If k8s/ |
| CI Workflows | ✅ | ✅ | ✅ | ✅ |
| Sentry | ✅ | Optional | ✅ | Optional |
| Documentation | ✅ | Optional | ✅ | ✅ |
| GitHub Pages | ✅ | Optional | ✅ | ✅ |
| Cache Busting | ✅ | ⏭️ SKIP | Optional | ⏭️ SKIP |
| Tests | ✅ | Optional | ✅ | ✅ |
| Coverage | ✅ | Optional | ✅ | ✅ |
| Linting | ✅ | Optional | ✅ | ✅ |
| Formatting | ✅ | Optional | ✅ | ✅ |
| Dead Code | ✅ | Optional | ✅ | ✅ |
| Editor | ✅ | ✅ | ✅ | ✅ |
| Security | ✅ | ✅ | ✅ | ✅ |

## See Also

- `/configure:status` - Quick read-only status overview
- `/configure:pre-commit` - Pre-commit specific checks
- `/configure:release-please` - Release automation checks
- `/configure:dockerfile` - Container configuration checks
- `/configure:skaffold` - Kubernetes development checks
- `/configure:workflows` - GitHub Actions checks
- `/configure:sentry` - Sentry error tracking checks
- `/configure:docs` - Documentation standards and generators
- `/configure:github-pages` - GitHub Pages deployment
- `/configure:cache-busting` - Cache-busting strategies
- `/configure:tests` - Testing framework setup
- `/configure:coverage` - Code coverage configuration
- `/configure:linting` - Linter configuration
- `/configure:formatting` - Code formatter setup
- `/configure:dead-code` - Dead code detection
- `/configure:editor` - Editor/IDE configuration
- `/configure:security` - Security scanning
