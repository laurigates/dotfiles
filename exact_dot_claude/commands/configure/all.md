---
description: Run all FVH infrastructure standards checks and configure compliance
allowed-tools: Glob, Grep, Read, Write, Edit, Bash, AskUserQuestion, TodoWrite, SlashCommand
argument-hint: "[--check-only] [--fix] [--type <frontend|infrastructure|python>]"
---

# /configure:all

Run all FVH (Forum Virium Helsinki) infrastructure standards compliance checks.

## Context

Orchestrator command that runs all `/configure:*` subcommands and provides a comprehensive compliance report.

## Workflow

### Phase 1: Project Detection

1. Read `.fvh-standards.yaml` if exists
2. Auto-detect project type:
   - **infrastructure**: Has `terraform/`, `helm/`, `argocd/`, or `*.tf` files
   - **frontend**: Has `package.json` with vue/react dependencies
   - **python**: Has `pyproject.toml` or `requirements.txt`
3. Allow override via `--type` flag
4. Report detected vs tracked type if different

### Phase 2: Run All Checks

Execute each configure command in check-only mode:

```
/configure:pre-commit --check-only
/configure:release-please --check-only
/configure:dockerfile --check-only
/configure:skaffold --check-only
/configure:workflows --check-only
```

Collect results from each check.

### Phase 3: Generate Comprehensive Report

```
╔══════════════════════════════════════════════════════════════╗
║           FVH Infrastructure Standards Compliance            ║
╠══════════════════════════════════════════════════════════════╣
║  Repository:    R4C-Cesium-Viewer                            ║
║  Project Type:  frontend (detected)                          ║
║  Standards:     2025.1                                       ║
║  Last Check:    2025-11-28 10:30:00                          ║
╚══════════════════════════════════════════════════════════════╝

Component Summary:
┌─────────────────┬──────────┬─────────────────────────────────┐
│ Component       │ Status   │ Notes                           │
├─────────────────┼──────────┼─────────────────────────────────┤
│ Pre-commit      │ ⚠️ WARN  │ 2 outdated hooks                │
│ Release-please  │ ✅ PASS  │ Fully compliant                 │
│ Dockerfile      │ ❌ FAIL  │ Missing healthcheck             │
│ Skaffold        │ ✅ PASS  │ 3 profiles configured           │
│ CI Workflows    │ ⚠️ WARN  │ Missing test workflow           │
└─────────────────┴──────────┴─────────────────────────────────┘

Overall Status: 1 FAIL, 2 WARN, 2 PASS

Issues to Fix:
  1. [FAIL] Dockerfile: Add HEALTHCHECK instruction
  2. [WARN] Pre-commit: Update conventional-pre-commit v3.6.0 → v4.3.0
  3. [WARN] Pre-commit: Update gruntwork/helmlint v0.1.23 → v0.1.29
  4. [WARN] Workflows: Add test.yml workflow

Run with --fix to apply automatic fixes.
```

### Phase 4: Apply Fixes (If Requested)

If `--fix` flag or user confirms:

1. Run each configure command with `--fix`:
   ```
   /configure:pre-commit --fix
   /configure:release-please --fix
   /configure:dockerfile --fix
   /configure:skaffold --fix
   /configure:workflows --fix
   ```

2. Report what was fixed and what requires manual intervention

### Phase 5: Update Standards Tracking

Create or update `.fvh-standards.yaml`:

```yaml
# FVH Standards Tracking
# Generated by /configure:all
standards_version: "2025.1"
project_type: "frontend"
last_configured: "2025-11-28T10:30:00Z"

components:
  pre-commit: "2025.1"
  release-please: "2025.1"
  dockerfile: "2025.1"
  skaffold: "2025.1"
  workflows: "2025.1"

# Documented deviations from standard
deviations: []
```

## Flags

| Flag | Description |
|------|-------------|
| `--check-only` | Report status without offering fixes |
| `--fix` | Apply all fixes automatically |
| `--type <type>` | Override project type (frontend, infrastructure, python) |

## Exit Codes (for CI)

| Code | Meaning |
|------|---------|
| 0 | All checks passed |
| 1 | Warnings found (non-blocking) |
| 2 | Failures found (blocking) |

## Examples

```bash
# Full compliance check with interactive fixes
/configure:all

# CI mode - check only, no fixes
/configure:all --check-only

# Auto-fix all issues
/configure:all --fix

# Force infrastructure type
/configure:all --type infrastructure
```

## Component Applicability

Not all components apply to all project types:

| Component | Frontend | Infrastructure | Python |
|-----------|----------|----------------|--------|
| Pre-commit | ✅ | ✅ | ✅ |
| Release-please | ✅ | Optional | ✅ |
| Dockerfile | ✅ | ⏭️ SKIP | ✅ |
| Skaffold | If k8s/ | ⏭️ SKIP | If k8s/ |
| CI Workflows | ✅ | ✅ | ✅ |

## See Also

- `/configure:status` - Quick read-only status overview
- `/configure:pre-commit` - Pre-commit specific checks
- `/configure:release-please` - Release automation checks
- `/configure:dockerfile` - Container configuration checks
- `/configure:skaffold` - Kubernetes development checks
- `/configure:workflows` - GitHub Actions checks
